## Triangulation 解题报告

### 算法原理

根据题意实现三角剖分算法即可。使用一个 **栈** 维护尚未剖分的多边形，栈中的节点形成一个优链。从左到右使用扫描线考虑新的节点的时候，都贪心地考虑能不能和栈中所有元素进行配对。

### 细节处理

#### 判断最左和最右侧这两个端点

枚举每个点并得出最小的 $x$ 和最大的 $x$，它们对应的就是最左侧和最右侧这两个端点。

#### 判断给出点的顺序是顺时针还是逆时针

考虑最右侧端点 `maxI`，和上一个端点 `pre`、下一个端点 `nxt`。如果从 `pre` 到 `maxI` 这个向量，和从 `maxI` 到 `nxt` 这个向量是顺时针旋转的，那么给出点的顺序就是顺时针；反之则为逆时针。

![判断给出点的顺序是顺时针还是逆时针](https://img.picgo.net/2023/10/22/pa2-19fcaed8587e18eaa.jpeg)

判断两个向量旋转方向的关系，可以通过检查它们 **叉积的正负号** 来判断。

#### 判断两个点是否在同一条边

从最左侧端点 `minI` 开始，顺着题目所给的方向对点编号，此时也能获取到最右侧端点 `maxI` 的编号 `maxID`。之后，给出三个点的时候，我们可以判断这两个点是否在 `maxID` 的 **同侧**，来判断这两个点是否在同一条边。

#### 判断是优角还是劣角

假设 $B$ 为角的顶点，且多边形上的顶点顺序为 $A \to B \to C$。考虑叉积 $p = \overrightarrow{AB} \times \overrightarrow{BC}$。

顺时针给出点坐标，与逆时针给出点坐标，对优角还是劣角的判断会产生影响。

1. 如果 $B$ 在上半部分：
    - 如果是顺时针旋转给出 $A \to B \to C$：
        $p < 0 \iff \angle ABC$ 为劣角。
    - 如果是逆时针旋转给出 $A \to B \to C$：
        $p > 0 \iff \angle ABC$ 为劣角。
2. 如果 $B$ 在下半部分：
    - 如果是顺时针旋转给出 $A \to B \to C$：
        $p > 0 \iff \angle ABC$ 为劣角。
    - 如果是逆时针旋转给出 $A \to B \to C$：
        $p < 0 \iff \angle ABC$ 为劣角。

![判断是优角还是劣角](https://img.picgo.net/2023/10/22/pa2-25a15a5cf34727aec.jpeg)

```cpp
bool ang(const Point& a, const Point& b, const Point& c) {
    // 检查以 b 为顶点，角 abc 是否为劣角
    if (b.id < maxID)
        return (1LL * (b.x - a.x) * (c.y - b.y) - 1LL * (b.y - a.y) * (c.x - b.x)) * rot < 0;
    else
        return (1LL * (b.x - a.x) * (c.y - b.y) - 1LL * (b.y - a.y) * (c.x - b.x)) * rot > 0;
}
```

### 时空复杂度分析

#### 时间复杂度

由于对点的 $x$ 坐标进行了从小到大排序，故此部分的代价为 $O(n\log n)$。在维护优链时，由于每一个点只会入栈、出栈 $1$ 次，故时间复杂度为 $O(n)$。综上所述，整体的时间复杂度为 $O(n \log n)$。

#### 空间复杂度

由于存储了 $n$ 个点的坐标，所以这部分的空间复杂度为 $O(n)$。对于额外维护的栈，由于每个元素最多只会入栈、出栈 $1$ 次，且在算法结束后栈为空，所以这个栈的大小也为 $O(n)$。综上所述，整体的空间复杂度为 $O(n)$。
